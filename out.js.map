{
  "version": 3,
  "sources": ["../src/index.ts"],
  "sourcesContent": ["const query = new URLSearchParams(location.search);\nconst is_dev = location.pathname.endsWith(\"-dev.html\");\n\nconst meta_id = is_dev ? \"3074457360393936567\" : \"3074457360394471343\";\n\nfunction libPath(id: LibID) {\n    if(location.pathname.endsWith(\"-dev.html\")) {\n        return \"/mirodnd/app-dev.html?page=\"+encodeURIComponent(id);\n    }else{\n        return \"/mirodnd/app.html?page=\"+encodeURIComponent(id);\n    }\n}\n\ntype Metadata = {\n    kind: \"random\",\n    min: number,\n    max: number,\n} | {\n    kind: \"frame_link\",\n    frame_id: string,\n} | {\n    kind: \"unknown\",\n};\n\nconst page = query.get(\"page\") as LibID | null;\n\ntype LibID = \"side_panel\" | \"unsupported\";\n\nif(page === \"side_panel\") {\n    document.body.appendChild(document.createTextNode(\"Hi!\"));\n\n    const btn = document.createElement(\"button\");\n    document.body.appendChild(btn);\n    btn.appendChild(document.createTextNode(\"Create D20\"));\n\n    btn.onclick = async () => {\n        const meta: Metadata = {\n            kind: \"random\",\n            min: 1,\n            max: 20,\n        };\n        await miro.board.widgets.create({type: 'sticker', text: 'Click to Roll', metadata: {\n            [meta_id]: meta,\n        }});\n        // woah widget.clientVisible\n    };\n\n    const fwbtn = document.createElement(\"button\");\n    document.body.appendChild(fwbtn);\n    fwbtn.appendChild(document.createTextNode(\"Create link to frame\"));\n\n    fwbtn.onclick = async () => {\n        const selected_items = await miro.board.selection.get();\n        if(selected_items.length !== 1) return alert(\"select frame then click\");\n        const selected = selected_items[0]!;\n        if(selected.type !== \"FRAME\") return alert(\"need frame\");\n        \n        const meta: Metadata = {\n            kind: \"frame_link\",\n            frame_id: selected.id,\n        };\n        await miro.board.widgets.create({type: 'sticker', text: 'Jump', metadata: {\n            [meta_id]: meta,\n        }});\n    };\n}else if(page == null){\n    document.body.appendChild(document.createTextNode(\"You should not be seeing this.\"));\n\n    // const icon24 = '<path fill=\"currentColor\" fill-rule=\"nonzero\" d=\"M20.156 7.762c-1.351-3.746-4.672-5.297-8.838-4.61-'\n    // +'3.9.642-7.284 3.15-7.9 5.736-1.14 4.784-.015 7.031 2.627 8.09.61.244 1.28.412 2.002.518.277.041.549.072.844.097.1'\n    // +'38.012.576.045.659.053.109.01.198.02.291.035 1.609.263 2.664 1.334 3.146 2.715 7.24-2.435 9.4-6.453 7.17-12.634zm'\n    // +'-18.684.662C3.18 1.256 18.297-3.284 22.038 7.084c2.806 7.78-.526 13.011-9.998 15.695-.266.076-.78.173-.759-.287.0'\n    // +'62-1.296-.47-2.626-1.762-2.837-1.009-.165-10.75.124-8.047-11.23zm9.427 4.113a6.853 6.853 0 0 0 1.787.172c.223.348'\n    // +'.442.733.79 1.366.53.967.793 1.412 1.206 2a1 1 0 1 0 1.636-1.15c-.358-.51-.593-.908-1.09-1.812-.197-.36-.358-.649'\n    // +'-.503-.899 1.16-.573 1.916-1.605 2.005-2.909.189-2.748-2.65-4.308-6.611-3.267-.443.117-.834.44-.886 1.408-.065 1.'\n    // +'192-.12 2.028-.25 3.825-.129 1.808-.185 2.653-.25 3.86a1 1 0 0 0 1.997.108c.05-.913.093-1.617.17-2.702zm.144-2.02'\n    // +'6c.077-1.106.124-1.82.171-2.675 2.398-.483 3.595.257 3.521 1.332-.08 1.174-1.506 1.965-3.692 1.343z\"/>';\n\n    const circle_icon = '<circle cx=\"12\" cy=\"12\" r=\"9\" fill=\"none\" fill-rule=\"evenodd\" stroke=\"currentColor\" stroke-width=\"2\"/>';\n\n    miro.onReady(() => {\n        miro.initialize({\n            extensionPoints: {\n                bottomBar: {\n                    title: 'Some title',\n                    svgIcon: circle_icon,\n                    onClick: async () => {\n                        const is_authorized = await miro.isAuthorized();\n                        if(!is_authorized) {\n                            await miro.requestAuthorization();\n                        }\n                        await miro.board.ui.openLeftSidebar(libPath(\"side_panel\"));\n                    }\n                }\n            },\n        }).catch(e => console.log(\"plugin init error\", e));\n\n        //eslint-disable-next-line @typescript-eslint/no-misused-promises\n        miro.addListener(\"SELECTION_UPDATED\", async (event) => {\n            //\n            const data = event.data as {id: string, metadata: {[key: string]: unknown}, type: string}[];\n            if(data.length !== 1) return;\n            const selxitm = data[0]!;\n            const meta = selxitm.metadata[meta_id] as Metadata | undefined;\n            if(!meta) return;\n\n            if(meta.kind === \"random\") {\n                const [widget] = await miro.board.widgets.get({id: selxitm.id, type: \"STICKER\"}) as [SDK.ITextWidget | undefined];\n                if(!widget) return;\n\n                widget.text = \"Num: \"+(((Math.random() * (meta.max - meta.min)) |0) + meta.min);\n\n                await miro.board.widgets.update(widget);\n\n                // const viewport = await miro.board.viewport.get();\n                // console.log(viewport);\n                // await miro.board.viewport.set({ x: -1858.2041958933646, y: -536.0726428187653, width: 5161.471103327495, height: 1356.217162872154 });\n            }else if(meta.kind === \"frame_link\") {\n                const [widget] = await miro.board.widgets.get({id: meta.frame_id, type: \"FRAME\"}) as [SDK.IFrameWidget | undefined];\n                if(!widget) return;\n                \n                console.log(await miro.board.viewport.get(), await miro.board.viewport.getScale(), widget);\n                await miro.board.viewport.set({x: widget.x - (widget.width / 2), y: widget.y - (widget.height / 2), width: widget.width, height: widget.height});\n            }\n        });\n    });\n}else{\n    document.body.appendChild(document.createTextNode(\"404 not found page: \"+page));\n}"],
  "mappings": ";;AAAA,MAAM,QAAQ,IAAI,gBAAgB,SAAS;AAC3C,MAAM,SAAS,SAAS,SAAS,SAAS;AAE1C,MAAM,UAAU,SAAS,wBAAwB;AAEjD,mBAAiB,IAAW;AACxB,QAAG,SAAS,SAAS,SAAS,cAAc;AACxC,aAAO,gCAA8B,mBAAmB;AAAA,WACvD;AACD,aAAO,4BAA0B,mBAAmB;AAAA;AAAA;AAe5D,MAAM,OAAO,MAAM,IAAI;AAIvB,MAAG,SAAS,cAAc;AACtB,aAAS,KAAK,YAAY,SAAS,eAAe;AAElD,UAAM,MAAM,SAAS,cAAc;AACnC,aAAS,KAAK,YAAY;AAC1B,QAAI,YAAY,SAAS,eAAe;AAExC,QAAI,UAAU,YAAY;AACtB,YAAM,OAAiB;AAAA,QACnB,MAAM;AAAA,QACN,KAAK;AAAA,QACL,KAAK;AAAA;AAET,YAAM,KAAK,MAAM,QAAQ,OAAO,EAAC,MAAM,WAAW,MAAM,iBAAiB,UAAU;AAAA,SAC9E,UAAU;AAAA;AAAA;AAKnB,UAAM,QAAQ,SAAS,cAAc;AACrC,aAAS,KAAK,YAAY;AAC1B,UAAM,YAAY,SAAS,eAAe;AAE1C,UAAM,UAAU,YAAY;AACxB,YAAM,iBAAiB,MAAM,KAAK,MAAM,UAAU;AAClD,UAAG,eAAe,WAAW;AAAG,eAAO,MAAM;AAC7C,YAAM,WAAW,eAAe;AAChC,UAAG,SAAS,SAAS;AAAS,eAAO,MAAM;AAE3C,YAAM,OAAiB;AAAA,QACnB,MAAM;AAAA,QACN,UAAU,SAAS;AAAA;AAEvB,YAAM,KAAK,MAAM,QAAQ,OAAO,EAAC,MAAM,WAAW,MAAM,QAAQ,UAAU;AAAA,SACrE,UAAU;AAAA;AAAA;AAAA,aAGd,QAAQ,MAAK;AAClB,aAAS,KAAK,YAAY,SAAS,eAAe;AAYlD,UAAM,cAAc;AAEpB,SAAK,QAAQ,MAAM;AACf,WAAK,WAAW;AAAA,QACZ,iBAAiB;AAAA,UACb,WAAW;AAAA,YACP,OAAO;AAAA,YACP,SAAS;AAAA,YACT,SAAS,YAAY;AACjB,oBAAM,gBAAgB,MAAM,KAAK;AACjC,kBAAG,CAAC,eAAe;AACf,sBAAM,KAAK;AAAA;AAEf,oBAAM,KAAK,MAAM,GAAG,gBAAgB,QAAQ;AAAA;AAAA;AAAA;AAAA,SAIzD,MAAM,OAAK,QAAQ,IAAI,qBAAqB;AAG/C,WAAK,YAAY,qBAAqB,OAAO,UAAU;AAEnD,cAAM,OAAO,MAAM;AACnB,YAAG,KAAK,WAAW;AAAG;AACtB,cAAM,UAAU,KAAK;AACrB,cAAM,OAAO,QAAQ,SAAS;AAC9B,YAAG,CAAC;AAAM;AAEV,YAAG,KAAK,SAAS,UAAU;AACvB,gBAAM,CAAC,UAAU,MAAM,KAAK,MAAM,QAAQ,IAAI,EAAC,IAAI,QAAQ,IAAI,MAAM;AACrE,cAAG,CAAC;AAAQ;AAEZ,iBAAO,OAAO,UAAW,OAAK,WAAY,MAAK,MAAM,KAAK,OAAO,KAAK,KAAK;AAE3E,gBAAM,KAAK,MAAM,QAAQ,OAAO;AAAA,mBAK3B,KAAK,SAAS,cAAc;AACjC,gBAAM,CAAC,UAAU,MAAM,KAAK,MAAM,QAAQ,IAAI,EAAC,IAAI,KAAK,UAAU,MAAM;AACxE,cAAG,CAAC;AAAQ;AAEZ,kBAAQ,IAAI,MAAM,KAAK,MAAM,SAAS,OAAO,MAAM,KAAK,MAAM,SAAS,YAAY;AACnF,gBAAM,KAAK,MAAM,SAAS,IAAI,EAAC,GAAG,OAAO,IAAK,OAAO,QAAQ,GAAI,GAAG,OAAO,IAAK,OAAO,SAAS,GAAI,OAAO,OAAO,OAAO,QAAQ,OAAO;AAAA;AAAA;AAAA;AAAA,SAInJ;AACD,aAAS,KAAK,YAAY,SAAS,eAAe,yBAAuB;AAAA;",
  "names": []
}
